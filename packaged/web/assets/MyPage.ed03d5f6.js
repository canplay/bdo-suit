import{d as A,Q as N}from"./decode_jwt.797f51e4.js";import{A as T,B as Q,r as y,o as U,C as F,aw as C,f as o,E as i,F as w,K as l,ax as P,H as D,J as g,Q as v,D as I,ay as r}from"./index.0f12b29b.js";import{Q as S,c as f,d as p,e as c,i as $}from"./QPage.e325be1f.js";import{Q as B}from"./QForm.8b179b98.js";import{_ as L,Q as M}from"./itemComp.66e8957e.js";import{g as z,a as X,u as h}from"./fetch.560fa2d8.js";import"./axios.fcd5266a.js";const Y={class:"row q-gutter-md"},Z={class:"row"},q={class:"col text-h6 text-bold"},H={class:"row"},J={class:"col text-body1"},K={class:"col text-body1"},W={class:"row"},j={class:"col"},G={class:"col"},O={class:"row"},R={class:"col"},ee={class:"col"},ue={class:"row"},ae={class:"col"},le={class:"col"},oe={class:"row"},te={class:"col"},se={class:"col"},ne={class:"row"},ie={class:"col"},de={class:"col"},re={class:"row"},ce={class:"col"},me={class:"col"},ve=l("div",{style:{height:"8px"}},null,-1),pe={class:"row"},he=l("div",{class:"col-auto",style:{width:"8px"}},null,-1),fe=l("div",{class:"col-auto",style:{width:"8px"}},null,-1),_e=l("div",{class:"col-auto",style:{width:"8px"}},null,-1),ye=l("div",{class:"col-auto",style:{height:"8px"}},null,-1),Fe={class:"row"},ge=l("div",{class:"col-auto",style:{width:"8px"}},null,-1),Ee=l("div",{style:{height:"8px"}},null,-1),Ce={class:"row"},we=l("div",{class:"col-auto",style:{width:"8px"}},null,-1),De=l("div",{class:"col-auto",style:{width:"8px"}},null,-1),Be=l("div",{class:"col-auto",style:{width:"8px"}},null,-1),ke=l("div",{class:"col-auto",style:{width:"8px"}},null,-1),Ie=T({__name:"MyPage",setup(Ve){const a=X(),n=Q(),d=y({username:"",password:"",familyName:""}),m=y({variousNo:"",enchantLevel:"0",itemCount:"0"}),t=y({show:!1,character:{},name:"",x:"",y:"",z:""}),_=s=>{let e=setTimeout(()=>{a.loading.hide(),clearTimeout(e)},12e4);switch(a.loading.show(),s){case"map":h().post(n.backend+"/api/user/update/map",{userNo:n.user.userno},a.cookies.get("canplay_token")).then(u=>{if(a.loading.hide(),clearTimeout(e),u.data.status===0){a.notify(u.data.msg);return}a.notify("\u89E3\u9501\u6210\u529F")}).catch(()=>{a.notify("\u7F51\u7EDC\u9519\u8BEF\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5"),a.loading.hide(),clearTimeout(e)});break;case"knowledge":h().post(n.backend+"/api/user/update/knowledge",{userNo:n.user.userno},a.cookies.get("canplay_token")).then(u=>{if(a.loading.hide(),clearTimeout(e),u.data.status===0){a.notify(u.data.msg);return}a.notify("\u89E3\u9501\u6210\u529F")}).catch(()=>{a.notify("\u7F51\u7EDC\u9519\u8BEF\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5"),a.loading.hide(),clearTimeout(e)});break;default:if(d.value.username===""||d.value.password===""||d.value.familyName===""){a.notify("\u7528\u6237\u540D\u3001\u5BC6\u7801\u6216\u5BB6\u65CF\u540D\u4E3A\u7A7A");return}h().post(n.backend+"/api/user/update/user",{userNo:n.user.userno,username:d.value.username,password:d.value.password,userNickname:d.value.familyName},a.cookies.get("canplay_token")).then(u=>{if(a.loading.hide(),clearTimeout(e),u.data.status===0){a.notify(u.data.msg);return}E(),a.notify("\u4FEE\u6539\u6210\u529F")}).catch(()=>{a.notify("\u7F51\u7EDC\u9519\u8BEF\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5"),a.loading.hide(),clearTimeout(e)});break}},k=()=>{let s=setTimeout(()=>{a.loading.hide(),clearTimeout(s)},12e4);a.loading.show(),h().post(n.backend+"/api/user/mail/send",{receiverName:n.user.username,receiverUserNo:n.user.userno,variousNo:parseInt(m.value.variousNo),enchantLevel:parseInt(m.value.enchantLevel),itemCount:parseInt(m.value.itemCount)},a.cookies.get("canplay_token")).then(e=>{if(a.loading.hide(),clearTimeout(s),e.data.status===0){if(e.data.msg==="no mail"){a.notify("\u90AE\u7BB1\u662F\u7A7A\u7684");return}a.notify(e.data.msg);return}a.notify("\u53D1\u9001\u90AE\u4EF6\u6210\u529F")}).catch(()=>{a.notify("\u7F51\u7EDC\u9519\u8BEF\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5"),a.loading.hide(),clearTimeout(s)})},V=()=>{let s=setTimeout(()=>{a.loading.hide(),clearTimeout(s)},12e4);a.loading.show(),h().post(n.backend+"/api/user/mail/clear",{receiverUserNo:n.user.userno},a.cookies.get("canplay_token")).then(e=>{if(a.loading.hide(),clearTimeout(s),e.data.status===0){a.notify(e.data.msg);return}a.notify("\u6E05\u7406\u90AE\u4EF6\u6210\u529F")}).catch(()=>{a.notify("\u7F51\u7EDC\u9519\u8BEF\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5"),a.loading.hide(),clearTimeout(s)})},b=s=>{t.value.character=s,t.value.name=s.characterName,t.value.x=s.currentPositionX,t.value.y=s.currentPositionY,t.value.z=s.currentPositionZ,t.value.show=!0},x=()=>{let s=setTimeout(()=>{a.loading.hide(),clearTimeout(s)},12e4);a.loading.show(),h().post(n.backend+"/api/user/character/update",{characterNo:t.value.character.characterNo,characterName:t.value.name,currentPositionX:parseInt(t.value.x),currentPositionY:parseInt(t.value.y),currentPositionZ:parseInt(t.value.z)},a.cookies.get("canplay_token")).then(e=>{if(a.loading.hide(),clearTimeout(s),e.data.status===0){a.notify(e.data.msg);return}E(),t.value.show=!1,a.notify("\u4FEE\u6539\u6210\u529F")}).catch(()=>{a.notify("\u7F51\u7EDC\u9519\u8BEF\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5")})},E=()=>{const s=A(a.cookies.get("canplay_token")).id;h().get(n.backend+"/api/user/info/"+s,a.cookies.get("canplay_token")).then(e=>{if(e.data.status===0){a.notify(e.data.msg);return}n.user={userno:e.data.msg.userNo,signin:!0,username:d.value.username,password:d.value.password,familyname:e.data.msg.userNickname,cash:0,pearl:0,permission:e.data.msg.permission,characters:e.data.msg.characters}}).catch(()=>{a.notify("\u7F51\u7EDC\u9519\u8BEF\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5")})};return U(()=>{d.value.username=n.user.username,d.value.password=n.user.password,d.value.familyName=n.user.familyname}),(s,e)=>(F(),C(w,null,[o(S,{padding:""},{default:i(()=>[l("div",Y,[(F(!0),C(w,null,P(D(n).user.characters,u=>(F(),I(f,{class:"col-auto",style:{width:"100%","max-width":"400px"},key:u},{default:i(()=>[o(N,{src:"imgs/logo.png"}),o(p,null,{default:i(()=>[l("div",Z,[l("div",q," \u89D2\u8272\u540D: "+r(u.characterName),1),o(v,{class:"col-3",color:"primary",label:"\u81EA\u52A9\u4FEE\u6539",onClick:be=>b(u)},null,8,["onClick"])]),l("div",H,[l("div",J,"\u7B49\u7EA7: "+r(u.level),1),l("div",K,"\u6E38\u73A9\u65F6\u957F: "+r(u.totalPlayTime),1)])]),_:2},1024),o($),o(p,{class:"text-body1"},{default:i(()=>[l("div",W,[l("div",j,"\u7ECF\u9A8C\u503C: "+r(u.experience),1),l("div",G,"\u5584\u6076\u503E\u5411: "+r(u.tendency),1)]),l("div",O,[l("div",R,"\u8D1F\u91CD: "+r(u.variedWeight),1),l("div",ee,"\u80CC\u5305\u6570\u91CF: "+r(u.inventorySlotCount),1)]),l("div",ue,[l("div",ae,"HP: "+r(u.hp),1),l("div",le,"MP: "+r(u.mp),1)]),l("div",oe,[l("div",te,"SP: "+r(u.sp),1),l("div",se,"WP: "+r(u.wp),1)]),l("div",ne,[l("div",ie,"\u5934\u8854: "+r(u.titleKey),1),l("div",de,"\u9632\u5FA1\u529B: "+r(u.defenceValue),1)]),l("div",re,[l("div",ce,"\u653B\u51FB\u529B: "+r(u.offenceValue),1),l("div",me,"\u89C9\u9192\u653B\u51FB\u529B: "+r(u.awakenValue),1)])]),_:2},1024)]),_:2},1024))),128))]),ve,o(f,null,{default:i(()=>[o(p,{class:"text-h6 text-bold"},{default:i(()=>[g("\u81EA\u52A9\u4FEE\u6539")]),_:1}),o(p,null,{default:i(()=>[o(B,{onSubmit:e[5]||(e[5]=u=>_("user"))},{default:i(()=>[l("div",pe,[o(c,{class:"col",modelValue:d.value.username,"onUpdate:modelValue":e[0]||(e[0]=u=>d.value.username=u),label:"\u7528\u6237\u540D"},null,8,["modelValue"]),he,o(c,{class:"col",modelValue:d.value.password,"onUpdate:modelValue":e[1]||(e[1]=u=>d.value.password=u),label:"\u5BC6\u7801"},null,8,["modelValue"]),fe,o(c,{class:"col",modelValue:d.value.familyName,"onUpdate:modelValue":e[2]||(e[2]=u=>d.value.familyName=u),label:"\u5BB6\u65CF\u540D"},null,8,["modelValue"]),_e,o(v,{class:"col-2",color:"primary",label:"\u4FEE\u6539",type:"submit"})]),ye,l("div",Fe,[o(v,{class:"col-2",color:"primary",label:"\u89E3\u9501\u5730\u56FE",onClick:e[3]||(e[3]=u=>_("map"))}),ge,o(v,{class:"col-2",color:"primary",label:"\u89E3\u9501\u77E5\u8BC6",onClick:e[4]||(e[4]=u=>_("knowledge"))})])]),_:1})]),_:1})]),_:1}),Ee,o(f,null,{default:i(()=>[o(p,{class:"text-h6 text-bold"},{default:i(()=>[g("\u81EA\u52A9\u90AE\u4EF6")]),_:1}),o(p,null,{default:i(()=>[o(B,{onSubmit:k},{default:i(()=>[l("div",Ce,[o(c,{class:"col",modelValue:m.value.variousNo,"onUpdate:modelValue":e[7]||(e[7]=u=>m.value.variousNo=u),label:"\u7269\u54C1ID"},{append:i(()=>[o(v,{color:"primary",label:"ID\u5217\u8868",onClick:e[6]||(e[6]=u=>D(n).dialog.items=!0)})]),_:1},8,["modelValue"]),we,o(c,{class:"col",modelValue:m.value.enchantLevel,"onUpdate:modelValue":e[8]||(e[8]=u=>m.value.enchantLevel=u),label:"\u5F3A\u5316\u7B49\u7EA7"},null,8,["modelValue"]),De,o(c,{class:"col",modelValue:m.value.itemCount,"onUpdate:modelValue":e[9]||(e[9]=u=>m.value.itemCount=u),label:"\u7269\u54C1\u6570\u91CF"},null,8,["modelValue"]),Be,o(v,{class:"col-2",color:"negative",label:"\u6E05\u7406",onClick:V}),ke,o(v,{class:"col-2",color:"primary",label:"\u53D1\u9001",type:"submit"})])]),_:1})]),_:1})]),_:1})]),_:1}),o(z,{modelValue:t.value.show,"onUpdate:modelValue":e[15]||(e[15]=u=>t.value.show=u)},{default:i(()=>[o(f,null,{default:i(()=>[o(p,{class:"text-h6"},{default:i(()=>[g("\u4FEE\u6539\u89D2\u8272\u540D")]),_:1}),o(p,null,{default:i(()=>[o(c,{modelValue:t.value.name,"onUpdate:modelValue":e[10]||(e[10]=u=>t.value.name=u),label:"\u89D2\u8272\u540D"},null,8,["modelValue"]),o(c,{modelValue:t.value.x,"onUpdate:modelValue":e[11]||(e[11]=u=>t.value.x=u),label:"\u5750\u6807X"},null,8,["modelValue"]),o(c,{modelValue:t.value.y,"onUpdate:modelValue":e[12]||(e[12]=u=>t.value.y=u),label:"\u5750\u6807Y"},null,8,["modelValue"]),o(c,{modelValue:t.value.z,"onUpdate:modelValue":e[13]||(e[13]=u=>t.value.z=u),label:"\u5750\u6807Z"},null,8,["modelValue"])]),_:1}),o(M,null,{default:i(()=>[o(v,{class:"fit",color:"primary",label:"\u786E\u5B9A",onClick:e[14]||(e[14]=u=>x())})]),_:1})]),_:1})]),_:1},8,["modelValue"]),o(L)],64))}});export{Ie as default};
