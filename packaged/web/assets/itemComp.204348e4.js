import{A as v,B,r as w,o as b,C as E,D as h,E as i,f as l,V as y,H as f}from"./index.53ff0679.js";import{d as k,f as _,e as P,c as V}from"./QPage.5b0197cd.js";import{a as Q,g as T,u as C}from"./fetch.a4faf46b.js";const U=v({__name:"itemComp",setup(I){const a=Q(),s=B(),e=w({pagination:{page:1,rowsNumber:0,rowsPerPage:7,sortBy:"",descending:!0},filter:"",columns:[{name:"gameid",label:"ID",field:"gameid",align:"center",sortable:!0},{name:"name",label:"\u540D\u79F0",field:"name",align:"center",sortable:!0}],rows:[]}),g=d=>{let t=setTimeout(()=>{a.loading.hide(),clearTimeout(t)},12e4);a.loading.show();const{page:o,rowsPerPage:r,sortBy:m,descending:p,rowsNumber:D}=d.pagination,F=d.filter;e.value.rows=[],C().post(s.backend+"/api/items/count",{filter:e.value.filter},a.cookies.get("canplay_token")).then(c=>{e.value.pagination.rowsNumber=parseInt(c.data.msg),parseInt(c.data.msg)<=0&&(a.loading.hide(),clearTimeout(t),a.notify("\u6CA1\u6709\u627E\u5230\u7269\u54C1")),C().post(s.backend+"/api/items/info",{filter:F,curPage:(o-1)*r,maxPage:r===0?D:r,sortBy:m===""?"gameid":m,descending:p},a.cookies.get("canplay_token")).then(u=>{if(a.loading.hide(),clearTimeout(t),u.data.status!=0)for(let n=0;n<u.data.msg.length&&u.data.msg[n].id!=="";++n)e.value.rows.push({gameid:u.data.msg[n].gameid,name:u.data.msg[n].name});else a.notify("\u7F51\u7EDC\u9519\u8BEF\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5");e.value.pagination.page=o,e.value.pagination.rowsPerPage=r,e.value.pagination.sortBy=m,e.value.pagination.descending=p}).catch(()=>{a.notify("\u7F51\u7EDC\u9519\u8BEF\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5"),a.loading.hide(),clearTimeout(t)})}).catch(()=>{a.notify("\u7F51\u7EDC\u9519\u8BEF\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5"),a.loading.hide(),clearTimeout(t)})};return b(()=>{g({pagination:e.value.pagination})}),(d,t)=>(E(),h(T,{modelValue:f(s).dialog.items,"onUpdate:modelValue":t[2]||(t[2]=o=>f(s).dialog.items=o)},{default:i(()=>[l(V,null,{default:i(()=>[l(k,null,{default:i(()=>[l(_,{title:"\u7269\u54C1ID\u5217\u8868",rows:e.value.rows,columns:e.value.columns,"row-key":"gameids",separator:"cell",pagination:e.value.pagination,"onUpdate:pagination":t[1]||(t[1]=o=>e.value.pagination=o),filter:e.value.filter,onRequest:g},{"top-right":i(()=>[l(P,{filled:"",dense:"",debounce:"1000",modelValue:e.value.filter,"onUpdate:modelValue":t[0]||(t[0]=o=>e.value.filter=o),label:"\u67E5\u627E"},{append:i(()=>[l(y,{name:"search"})]),_:1},8,["modelValue"])]),_:1},8,["rows","columns","pagination","filter"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}});export{U as _};
